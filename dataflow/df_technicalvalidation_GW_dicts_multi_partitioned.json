{
    "name": "df_technicalvalidation_GW_dicts_multi_partitioned",
    "properties": {
        "folder": {
            "name": "DataFlows/"
        },
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "ds_adslv2_PARQUET",
                        "type": "DatasetReference"
                    },
                    "name": "Source"
                }
            ],
            "sinks": [
                {
                    "dataset": {
                        "referenceName": "ds_adslv2_parquet_no_file_name",
                        "type": "DatasetReference"
                    },
                    "name": "Target"
                },
                {
                    "dataset": {
                        "referenceName": "ds_adslv2_parquet_no_file_name",
                        "type": "DatasetReference"
                    },
                    "name": "Error"
                }
            ],
            "transformations": [
                {
                    "name": "SelectRenameColumns"
                },
                {
                    "name": "TechnicalValidation"
                },
                {
                    "name": "DerivePartitionColumn"
                }
            ],
            "script": "parameters{\n\tdf_src_column_list as string[],\n\tdf_src_renamed_column_list as string[],\n\tdf_tech_validation_expr as boolean,\n\tdf_partition_column as string[]\n}\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet') ~> Source\nSource select(mapColumn(\n\t\teach(match(name==$df_src_column_list[1]),\n\t\t\t$df_src_renamed_column_list[1] = $$),\n\t\teach(match(name==$df_src_column_list[2]),\n\t\t\t$df_src_renamed_column_list[2] = $$),\n\t\teach(match(name==$df_src_column_list[3]),\n\t\t\t$df_src_renamed_column_list[3] = $$),\n\t\teach(match(name==$df_src_column_list[4]),\n\t\t\t$df_src_renamed_column_list[4] = $$),\n\t\teach(match(name==$df_src_column_list[5]),\n\t\t\t$df_src_renamed_column_list[5] = $$),\n\t\teach(match(name==$df_src_column_list[6]),\n\t\t\t$df_src_renamed_column_list[6] = $$),\n\t\teach(match(name==$df_src_column_list[7]),\n\t\t\t$df_src_renamed_column_list[7] = $$),\n\t\teach(match(name==$df_src_column_list[8]),\n\t\t\t$df_src_renamed_column_list[8] = $$),\n\t\teach(match(name==$df_src_column_list[9]),\n\t\t\t$df_src_renamed_column_list[9] = $$),\n\t\teach(match(name==$df_src_column_list[10]),\n\t\t\t$df_src_renamed_column_list[10] = $$),\n\t\teach(match(name==$df_src_column_list[11]),\n\t\t\t$df_src_renamed_column_list[11] = $$),\n\t\teach(match(name==$df_src_column_list[12]),\n\t\t\t$df_src_renamed_column_list[12] = $$),\n\t\teach(match(name==$df_src_column_list[13]),\n\t\t\t$df_src_renamed_column_list[13] = $$),\n\t\teach(match(name==$df_src_column_list[14]),\n\t\t\t$df_src_renamed_column_list[14] = $$),\n\t\teach(match(name==$df_src_column_list[15]),\n\t\t\t$df_src_renamed_column_list[15] = $$),\n\t\teach(match(name==$df_src_column_list[16]),\n\t\t\t$df_src_renamed_column_list[16] = $$),\n\t\teach(match(name==$df_src_column_list[17]),\n\t\t\t$df_src_renamed_column_list[17] = $$),\n\t\teach(match(name==$df_src_column_list[18]),\n\t\t\t$df_src_renamed_column_list[18] = $$),\n\t\teach(match(name==$df_src_column_list[19]),\n\t\t\t$df_src_renamed_column_list[19] = $$),\n\t\teach(match(name==$df_src_column_list[20]),\n\t\t\t$df_src_renamed_column_list[20] = $$),\n\t\teach(match(name==$df_src_column_list[21]),\n\t\t\t$df_src_renamed_column_list[21] = $$),\n\t\teach(match(name==$df_src_column_list[22]),\n\t\t\t$df_src_renamed_column_list[22] = $$),\n\t\teach(match(name==$df_src_column_list[23]),\n\t\t\t$df_src_renamed_column_list[23] = $$),\n\t\teach(match(name==$df_src_column_list[24]),\n\t\t\t$df_src_renamed_column_list[24] = $$),\n\t\teach(match(name==$df_src_column_list[25]),\n\t\t\t$df_src_renamed_column_list[25] = $$),\n\t\teach(match(name==$df_src_column_list[26]),\n\t\t\t$df_src_renamed_column_list[26] = $$),\n\t\teach(match(name==$df_src_column_list[27]),\n\t\t\t$df_src_renamed_column_list[27] = $$),\n\t\teach(match(name==$df_src_column_list[28]),\n\t\t\t$df_src_renamed_column_list[28] = $$),\n\t\teach(match(name==$df_src_column_list[29]),\n\t\t\t$df_src_renamed_column_list[29] = $$),\n\t\teach(match(name==$df_src_column_list[30]),\n\t\t\t$df_src_renamed_column_list[30] = $$),\n\t\teach(match(name==$df_src_column_list[31]),\n\t\t\t$df_src_renamed_column_list[31] = $$),\n\t\teach(match(name==$df_src_column_list[32]),\n\t\t\t$df_src_renamed_column_list[32] = $$),\n\t\teach(match(name==$df_src_column_list[33]),\n\t\t\t$df_src_renamed_column_list[33] = $$),\n\t\teach(match(name==$df_src_column_list[34]),\n\t\t\t$df_src_renamed_column_list[34] = $$),\n\t\teach(match(name==$df_src_column_list[35]),\n\t\t\t$df_src_renamed_column_list[35] = $$),\n\t\teach(match(name==$df_src_column_list[36]),\n\t\t\t$df_src_renamed_column_list[36] = $$),\n\t\teach(match(name==$df_src_column_list[37]),\n\t\t\t$df_src_renamed_column_list[37] = $$),\n\t\teach(match(name==$df_src_column_list[38]),\n\t\t\t$df_src_renamed_column_list[38] = $$),\n\t\teach(match(name==$df_src_column_list[39]),\n\t\t\t$df_src_renamed_column_list[39] = $$),\n\t\teach(match(name==$df_src_column_list[40]),\n\t\t\t$df_src_renamed_column_list[40] = $$),\n\t\teach(match(name==$df_src_column_list[41]),\n\t\t\t$df_src_renamed_column_list[41] = $$),\n\t\teach(match(name==$df_src_column_list[42]),\n\t\t\t$df_src_renamed_column_list[42] = $$),\n\t\teach(match(name==$df_src_column_list[43]),\n\t\t\t$df_src_renamed_column_list[43] = $$),\n\t\teach(match(name==$df_src_column_list[44]),\n\t\t\t$df_src_renamed_column_list[44] = $$),\n\t\teach(match(name==$df_src_column_list[45]),\n\t\t\t$df_src_renamed_column_list[45] = $$),\n\t\teach(match(name==$df_src_column_list[46]),\n\t\t\t$df_src_renamed_column_list[46] = $$),\n\t\teach(match(name==$df_src_column_list[47]),\n\t\t\t$df_src_renamed_column_list[47] = $$),\n\t\teach(match(name==$df_src_column_list[48]),\n\t\t\t$df_src_renamed_column_list[48] = $$),\n\t\teach(match(name==$df_src_column_list[49]),\n\t\t\t$df_src_renamed_column_list[49] = $$),\n\t\teach(match(name==$df_src_column_list[50]),\n\t\t\t$df_src_renamed_column_list[50] = $$),\n\t\teach(match(name==$df_src_column_list[51]),\n\t\t\t$df_src_renamed_column_list[51] = $$),\n\t\teach(match(name==$df_src_column_list[52]),\n\t\t\t$df_src_renamed_column_list[52] = $$),\n\t\teach(match(name==$df_src_column_list[53]),\n\t\t\t$df_src_renamed_column_list[53] = $$),\n\t\teach(match(name==$df_src_column_list[54]),\n\t\t\t$df_src_renamed_column_list[54] = $$),\n\t\teach(match(name==$df_src_column_list[55]),\n\t\t\t$df_src_renamed_column_list[55] = $$),\n\t\teach(match(name==$df_src_column_list[56]),\n\t\t\t$df_src_renamed_column_list[56] = $$),\n\t\teach(match(name==$df_src_column_list[57]),\n\t\t\t$df_src_renamed_column_list[57] = $$),\n\t\teach(match(name==$df_src_column_list[58]),\n\t\t\t$df_src_renamed_column_list[58] = $$),\n\t\teach(match(name==$df_src_column_list[59]),\n\t\t\t$df_src_renamed_column_list[59] = $$),\n\t\teach(match(name==$df_src_column_list[60]),\n\t\t\t$df_src_renamed_column_list[60] = $$),\n\t\teach(match(name==$df_src_column_list[61]),\n\t\t\t$df_src_renamed_column_list[61] = $$),\n\t\teach(match(name==$df_src_column_list[62]),\n\t\t\t$df_src_renamed_column_list[62] = $$),\n\t\teach(match(name==$df_src_column_list[63]),\n\t\t\t$df_src_renamed_column_list[63] = $$),\n\t\teach(match(name==$df_src_column_list[64]),\n\t\t\t$df_src_renamed_column_list[64] = $$),\n\t\teach(match(name==$df_src_column_list[65]),\n\t\t\t$df_src_renamed_column_list[65] = $$),\n\t\teach(match(name==$df_src_column_list[66]),\n\t\t\t$df_src_renamed_column_list[66] = $$),\n\t\teach(match(name==$df_src_column_list[67]),\n\t\t\t$df_src_renamed_column_list[67] = $$),\n\t\teach(match(name==$df_src_column_list[68]),\n\t\t\t$df_src_renamed_column_list[68] = $$),\n\t\teach(match(name==$df_src_column_list[69]),\n\t\t\t$df_src_renamed_column_list[69] = $$),\n\t\teach(match(name==$df_src_column_list[70]),\n\t\t\t$df_src_renamed_column_list[70] = $$),\n\t\teach(match(name==$df_src_column_list[71]),\n\t\t\t$df_src_renamed_column_list[71] = $$),\n\t\teach(match(name==$df_src_column_list[72]),\n\t\t\t$df_src_renamed_column_list[72] = $$),\n\t\teach(match(name==$df_src_column_list[73]),\n\t\t\t$df_src_renamed_column_list[73] = $$),\n\t\teach(match(name==$df_src_column_list[74]),\n\t\t\t$df_src_renamed_column_list[74] = $$),\n\t\teach(match(name==$df_src_column_list[75]),\n\t\t\t$df_src_renamed_column_list[75] = $$),\n\t\teach(match(name==$df_src_column_list[76]),\n\t\t\t$df_src_renamed_column_list[76] = $$),\n\t\teach(match(name==$df_src_column_list[77]),\n\t\t\t$df_src_renamed_column_list[77] = $$),\n\t\teach(match(name==$df_src_column_list[78]),\n\t\t\t$df_src_renamed_column_list[78] = $$),\n\t\teach(match(name==$df_src_column_list[79]),\n\t\t\t$df_src_renamed_column_list[79] = $$),\n\t\teach(match(name==$df_src_column_list[80]),\n\t\t\t$df_src_renamed_column_list[80] = $$),\n\t\teach(match(name==$df_src_column_list[81]),\n\t\t\t$df_src_renamed_column_list[81] = $$),\n\t\teach(match(name==$df_src_column_list[82]),\n\t\t\t$df_src_renamed_column_list[82] = $$),\n\t\teach(match(name==$df_src_column_list[83]),\n\t\t\t$df_src_renamed_column_list[83] = $$),\n\t\teach(match(name==$df_src_column_list[84]),\n\t\t\t$df_src_renamed_column_list[84] = $$),\n\t\teach(match(name==$df_src_column_list[85]),\n\t\t\t$df_src_renamed_column_list[85] = $$),\n\t\teach(match(name==$df_src_column_list[86]),\n\t\t\t$df_src_renamed_column_list[86] = $$),\n\t\teach(match(name==$df_src_column_list[87]),\n\t\t\t$df_src_renamed_column_list[87] = $$),\n\t\teach(match(name==$df_src_column_list[88]),\n\t\t\t$df_src_renamed_column_list[88] = $$),\n\t\teach(match(name==$df_src_column_list[89]),\n\t\t\t$df_src_renamed_column_list[89] = $$),\n\t\teach(match(name==$df_src_column_list[90]),\n\t\t\t$df_src_renamed_column_list[90] = $$),\n\t\teach(match(name==$df_src_column_list[91]),\n\t\t\t$df_src_renamed_column_list[91] = $$),\n\t\teach(match(name==$df_src_column_list[92]),\n\t\t\t$df_src_renamed_column_list[92] = $$),\n\t\teach(match(name==$df_src_column_list[93]),\n\t\t\t$df_src_renamed_column_list[93] = $$),\n\t\teach(match(name==$df_src_column_list[94]),\n\t\t\t$df_src_renamed_column_list[94] = $$),\n\t\teach(match(name==$df_src_column_list[95]),\n\t\t\t$df_src_renamed_column_list[95] = $$),\n\t\teach(match(name==$df_src_column_list[96]),\n\t\t\t$df_src_renamed_column_list[96] = $$),\n\t\teach(match(name==$df_src_column_list[97]),\n\t\t\t$df_src_renamed_column_list[97] = $$),\n\t\teach(match(name==$df_src_column_list[98]),\n\t\t\t$df_src_renamed_column_list[98] = $$),\n\t\teach(match(name==$df_src_column_list[99]),\n\t\t\t$df_src_renamed_column_list[99] = $$),\n\t\teach(match(name==$df_src_column_list[100]),\n\t\t\t$df_src_renamed_column_list[100] = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectRenameColumns\nDerivePartitionColumn split($df_tech_validation_expr,\n\tdisjoint: false) ~> TechnicalValidation@(GoodRows, BadRows)\nSelectRenameColumns derive(dict_name1 = toString(byName($df_partition_column[1])),\n\t\tdictname2 = toString(byName($df_partition_column[2]))) ~> DerivePartitionColumn\nTechnicalValidation@GoodRows sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\ttruncate: true,\n\tpartitionBy('key',\n\t\t0,\n\t\tdict_name1,\n\t\tdictname2\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Target\nTechnicalValidation@BadRows sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\ttruncate: true,\n\tpartitionBy('key',\n\t\t0,\n\t\tdict_name1,\n\t\tdictname2\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Error"
        }
    }
}